import pandas as pd

# Load dataset
df = pd.read_csv('adult.csv')
print(df.columns)

# Clean missing values
df.replace('?', pd.NA, inplace=True)
df.dropna(inplace=True)

# 1. Race count
race_count = df['race'].value_counts()

# 2. Average age of men
average_age_men = round(df[df['sex'] == 'Male']['age'].mean(), 1)

# 3. Percentage with Bachelor's degree
percentage_bachelors = round((df['education'] == 'Bachelors').mean() * 100, 1)

# 4. Advanced education earning >50K
advanced_education = df['education'].isin(['Bachelors', 'Masters', 'Doctorate'])
higher_education_rich = round((df[advanced_education]['income'] == '>50K').mean() * 100, 1)

# 5. Without advanced education earning >50K
lower_education = ~advanced_education
lower_education_rich = round((df[lower_education]['income'] == '>50K').mean() * 100, 1)

# 6. Minimum hours per week
min_hours_per_week = df['hours.per.week'].min()

# 7. % earning >50K among those working minimum hours
min_hours_rich = round(
    (df[df['hours.per.week'] == min_hours_per_week]['income'] == '>50K').mean() * 100, 1
)

# 8. Country with highest % earning >50K
country_percentage = (
    df[df['income'] == '>50K']
    .groupby('native.country')
    .size()
    /
    df.groupby('native.country').size()
) * 100

highest_earning_country = country_percentage.idxmax()
highest_earning_percentage = round(country_percentage.max(), 1)

# 9. Most popular occupation in India earning >50K
popular_occupation_india = (
    df[(df['native.country'] == 'India') & (df['income'] == '>50K')]
    ['occupation']
    .value_counts()
    .idxmax()
)

# Print results
print("Race Count:\n", race_count)
print("Average Age of Men:", average_age_men)
print("Percentage with Bachelor's:", percentage_bachelors)
print("Advanced Education earning >50K:", higher_education_rich)
print("Lower Education earning >50K:", lower_education_rich)
print("Minimum Hours per Week:", min_hours_per_week)
print("Min Hours earning >50K:", min_hours_rich)
print("Highest Earning Country:", highest_earning_country)
print("Highest Percentage:", highest_earning_percentage)
print("Top Occupation in India (>50K):", popular_occupation_india)
